{
  "version": "1.1",
  "project": {
    "name": "my-project",
    "stack": "generic"
  },
  "backlog": {
    "dataDir": "backlog/data",
    "templatesDir": "backlog/templates",
    "ticketPrefixes": ["FEAT", "BUG", "SEC", "QUALITY", "REFACTOR", "TEST"],
    "requiredSections": [
      "context",
      "description",
      "acceptanceCriteria",
      "testStrategy",
      "affectedFiles",
      "dependencies"
    ]
  },
  "qualityGates": {
    "testCommand": "echo 'Configure testCommand in backlog.config.json'"
  },
  "codeRules": {
    "source": ".claude/code-rules.md",
    "hardGates": [],
    "softGates": []
  },
  "ticketValidation": {
    "requireTestStrategy": true,
    "requireAffectedFiles": true,
    "requireDependencyCheck": true,
    "minAcceptanceCriteria": 3,
    "requireVerificationCommands": true
  },
  "agentRouting": {
    "rules": [
      {
        "pattern": "BUG*",
        "agent": "investigator",
        "label": "Route bugs to investigator first"
      },
      {
        "pattern": "SEC*",
        "agent": "security-reviewer",
        "label": "Route security tickets to security reviewer"
      },
      {
        "pattern": "FEAT*",
        "agent": "implementer",
        "label": "Route features to implementer"
      }
    ],
    "overrides": {},
    "llmOverride": true
  },
  "reviewPipeline": {
    "reviewers": [
      {
        "name": "code-quality",
        "agent": "reviewer",
        "focus": "Code quality, readability, and adherence to project conventions",
        "required": true
      },
      {
        "name": "test-coverage",
        "agent": "reviewer",
        "focus": "Test completeness, edge cases, and meaningful assertions",
        "required": true
      }
    ],
    "confidenceThreshold": 80,
    "maxReviewRounds": 3
  },
  "llmOps": {
    "registry": {
      "source": ".backlog-ops/model-registry.json",
      "refreshCommand": "bash scripts/ops/sync-model-registry.sh",
      "strictMode": true
    },
    "gateway": {
      "baseURL": "http://localhost:8000",
      "apiKeyEnv": "LITELLM_MASTER_KEY",
      "requireEscalationReason": true
    },
    "routing": {
      "entryModelClassify": "free",
      "entryModelPlan": "free",
      "entryModelDraft": "free",
      "entryModelImplement": "cheap",
      "entryModelReview": "balanced",
      "escalationModel": "frontier",
      "maxEscalationsPerTicket": 1
    },
    "tokenPolicy": {
      "maxInputByPhase": {
        "classify": 4000,
        "draft": 8000,
        "implement": 32000,
        "review": 16000,
        "refine": 12000
      },
      "maxOutputByPhase": {
        "classify": 1000,
        "draft": 4000,
        "implement": 16000,
        "review": 4000,
        "refine": 8000
      },
      "contextWindowStrategy": "summarize"
    },
    "cachePolicy": {
      "providerPromptCaching": true,
      "stablePrefixMinTokens": 2048,
      "responseCache": {
        "enabled": true,
        "ttlSeconds": 3600,
        "backend": "redis"
      },
      "semanticCache": {
        "enabled": false,
        "backend": "qdrant",
        "threshold": 0.88
      }
    },
    "batchPolicy": {
      "enabled": true,
      "eligiblePhases": ["refinement", "bulk-ticket-validation", "cost-report", "duplicate-detection", "implementation"],
      "forceBatchWhenQueueOver": 1,
      "maxConcurrentBatchJobs": 10,
      "retryPolicy": {
        "maxRetries": 3,
        "backoffMultiplier": 2.0
      }
    },
    "ragPolicy": {
      "enabled": true,
      "embeddingModel": "all-MiniLM-L6-v2",
      "vectorStore": "chromadb",
      "indexPath": ".backlog-ops/rag-index",
      "serverUrl": "http://localhost:8001",
      "chunkSize": 512,
      "topK": 5,
      "reindexCommand": "python scripts/ops/rag_index.py --rebuild"
    }
  },
  "sentinel": {
    "enabled": true,
    "installGitHook": true,
    "prescan": {
      "runLinter": true,
      "runTests": true,
      "runTypeCheck": true,
      "detectHardcoded": true,
      "detectTodos": true,
      "maxFunctionLines": 80
    },
    "reviewers": {
      "security": true,
      "quality": true
    },
    "ragDeduplication": true,
    "patternThresholds": {
      "recurring": 2,
      "escalateToSoftGate": 3,
      "escalateToHardGate": 5
    },
    "ticketMapping": {
      "security": "BUG",
      "bug": "BUG",
      "techDebt": "TASK",
      "architecture": "TASK"
    }
  }
}
